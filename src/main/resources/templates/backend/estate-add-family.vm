$breadcrumbs.add("Estates","estate-list.jsp").add("$estate.name","estate-show.jsp?id=$estate.id").add("associate family")


## Update to use https://twitter.github.io/typeahead.js/examples/
<script src="${TYPEAHEAD_SCRIPT}"></script>

<form action="estate-add-family-submit.jsp" method="POST">

<input type="hidden" name="estate_id" value="${estate.id}" />

<div class="form-group">
<label for="acinput" >Family to add:</label>
<input id="acinput" class="typeahead" type="text" name="family" size="32" />
<input type="hidden" name="family_id" value="" />
</div>


<input type="submit" class="btn btn-primary" value="Add" />
<input type="submit" class="btn btn-default" name="_submit_cancel" value="Cancel" />
</form>

<script>

jQuery(function(){
	jQuery('#acinput').typeahead(null,
	{
		afterSelect: function(val) {
			alert(val);
			console.log("val="+val);
			this.$element.val(""); 
		},
		display: 'name',
		source: function(query,process) {
			console.log("process="+process);
			// TODO: async false is deprecated
			var result = null;
			jQuery.ajax({
				url: "family-query.jsp?q="+query,
				type: "get",
				dataType: "html",
				async: false,
				success: function(data) {
					result = data;
				} 
			});
			console.log(result);
			console.log(JSON.parse(result));
			process(JSON.parse(result));
			//return  JSON.parse(result);
		}
	});
	jQuery("#acinput").bind('typeahead:select', function(ev, suggestion) {
		jQuery("input[name='family_id']").val(suggestion.id);
	});
});

</script>
