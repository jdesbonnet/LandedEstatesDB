$breadcrumbs.add("Estates","estate-list.jsp").add($estate.name)


<h3>Associated Families</h3>

<ul class="bulletList">
#foreach ($family in $estate.families)
<li> <a href="family-show.jsp?id=$family.id">$family.name</a> 
#if ($family.title && $family.title.length() > 0)
<em>(${family.title})</em>
#end
</li>
#end
</ul>

#if ($estate.families.size() == 0)
<em>none</em>
#end


<h3>Description</h3>
$!estate.description
#if (! $estate.description || $estate.description.length()==0)
<em>none</em>
#end



<h3>Houses</h3>

#if ($estate.houses.size() == 0) 
<em>none</em>
#else
<table class="listTable">
<thead>
<tr>
<th width="300">House Name / Description</th>
<th>Townland</th>
<th>Civil Parish</th>
<th>PLU</th>
<th>DED</th>
<th>Barony</th>
<th>County</th>
<th>OS Grid Reference / Map</th>
</tr>
</thead>

<tbody>
#foreach ($house in $estate.houses) 
<tr valign="top">
<td>

##
## If just one image float to right of cell
##

#if ($house.getImages().size() == 1)
#foreach ($image in $house.getImages())
<img alt="image" src="$contextPath/img/tn/$image.getId()" align="right" />
#end
#end

<a href="house-show.jsp?id=${house.id}">${house.name}</a>
<br />

$!house.description

##
## If more than one house then list after description
##

#if ($house.images.size() > 1)
<br />
#foreach ($image in $house.images)
<img alt="image" src="$contextPath/img/tn/${image.id}" />
#end
#end


</td>

<td>$!house.getTownland() &nbsp;</td>
<td>$!house.getCivilParish() &nbsp;</td>
<td>$!house.getPlu() &nbsp;</td>
<td>$!house.getDed() &nbsp;</td>
<td>$!house.getBarony() &nbsp;</td>
<td>$!house.getCounty() &nbsp;</td>

<td>
#if ($house.hasGridReference())
<a href="javascript:popupMap('gridref=${house.gridReference}')">${house.gridReference}</a>
#end
#if ($house.discoveryMap)
Discovery map #${house.discoveryMap}.
#end
#if ($house.osSheet)
OS Sheet #${house.osSheet}.
#end
</td>

</tr>
#end
</tbody>
</table>
#end
## End list of houses


##
## Employee Records
##
#parse ("/backend/_employee_record_reference_table.vm")
<h3>Historical Employee Records</h3>
#parse("_employee_record_table.vm")
<a class="btn btn-primary btn-sm" href="employee-record-add.jsp?estate_id=${estate.id}">Add employee record</a>
## End list of Employee Records



#if ($estate.getReferences().size() == 0)
<em>none</em>
#end


#foreach ($refCatName in $referenceCategoryNames)
<h3>$refCatName</h3>
<ul class="bulletList">
#foreach ($reference in $referenceCategories.get($refCatName))
<li> <a href="refsource-show.jsp?id=$reference.source.id">$jsp.markingsToHtml(${reference.source.name})</a>: 
$jsp.markingsToHtml($reference.description) </li>
#end
</ul>


#if ($referenceCategories.get($referenceCategoryName).size()==0)
<em>none</em>
#end

#end

#if ($problemReferences.size() > 0)
<div class="warning">
<h3>problematic references</h3>
<ul class="bulletList">
#foreach ($ref in $problemReferences)
	<li> <a href="reference-edit.jsp?id=$ref.getId()">Reference#$ref.getId()</a>,
	source=
	#if ($ref.getSource() ) 
		$ref.getSource().getName(): 
	#else 
		<span class="errorMessage">No reference source set</span>
	#end
	
	description=
	#if ($ref.getDescription())
		$ref.getDescription()
	#else
		<span class="errorMessage">No reference description</span>
	#end
	
	</li>
#end
</ul>
Please edit this Estate record and correct issues highlighted above.
</div>
#end


<a class="btn btn-primary" href="estate-edit.jsp?id=$estate.getId()">Edit</a>

